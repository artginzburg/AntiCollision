!function(){function t(t){if(Array.isArray(t))return t}function e(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function o(i,o){return t(i)||e(i)||r(i,o)||n()}function a(t){if(Array.isArray(t))return i(t)}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return a(t)||e(t)||r(t)||u()}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function d(t){return h(0,t)}function h(t,e){return Math.random()*(e-t)+t}var v={drawTraces:!0,useAntiCollisionBug:!0,strokeBalls:!0,dragWithMouseOver:!1,bounciness:0};window.settings=v;var y,m,p,w=function(){"use strict";function t(e,n,i){s(this,t),this.x=e,this.y=n,this.z=i}return f(t,[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)}},{key:"mul",value:function(e){return new t(this.x*e,this.y*e,this.z*e)}},{key:"div",value:function(e){return new t(this.x/e,this.y/e,this.z/e)}},{key:"toRGB",value:function(){return"rgb(".concat(this.x," ").concat(this.y," ").concat(this.z,")")}},{key:"toRGBA",value:function(t){return"rgba(".concat(this.x,", ").concat(this.y,", ").concat(this.z,", ").concat(t,")")}}]),t}();m=y||(y={}),p=new w(255,255,255),m.invert=function(t){return p.sub(t)};var b,g,k,S=function(){"use strict";function t(e,n){s(this,t),this.x=e,this.y=n}return f(t,[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"mul",value:function(e){return new t(this.x*e,this.y*e)}},{key:"div",value:function(e){return new t(this.x/e,this.y/e)}}]),t}();(g=b||(b={})).length=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},g.rotate=function(t,e,n){var i=Math.atan2(t.y,t.x)-Math.PI/2*e*n;return new S(Math.cos(i),Math.sin(i)).mul(b.length(t))},(k=g.RotationDirection||(g.RotationDirection={}))[k.Left=1]="Left",k[k.Right=-1]="Right";var x=new w(0,0,0),L=new w(255,255,255),_=L.toRGB();function E(t){var e=t.reduce((function(t,e){return t.stableScore<e.stableScore?t:e}));t.forEach((function(t){t.hasLeastStableScore=!1})),e.hasLeastStableScore=!0}function P(t){t.stableScore+=t.stableCount}function M(t,e){e.hasLeastStableScore&&(t.fillStyle=y.invert(e.color).toRGBA(.87),t.beginPath(),t.arc(e.position.x,e.position.y,e.r/5,0,2*Math.PI),t.fill(),t.closePath())}var R=1;function A(t){return void 0!==t.scale}var C,O,T=.35;function I(t,e){return n=t.clientX,i=t.clientY,r=e.clientX,o=e.clientY,Math.sqrt(Math.pow(n-r,2)+Math.pow(i-o,2));var n,i,r,o}function j(){return.18/(Math.abs(-1.55/T)/15.5)}(O=C||(C={})).desktopInverted=5e3,O.mobileInverted=500,O.desktopPinch=C.mobileInverted/1e3;var B=100,D=function(){"use strict";function t(e,n,i){s(this,t),this.r=i,this.stableScore=0,this.hasLeastStableScore=!1,this.position=new S(e,n),this.velocity=new S(h(-4,4),h(-4,4)),this.r=i,this.position_history=Array(B).fill(this.position),this.current_idx=0,this.stableCount=0}return f(t,[{key:"save",value:function(){this.position_history[this.current_idx]=this.position,this.current_idx=++this.current_idx%B}},{key:"getVA",value:function(){for(var t=[],e=0;e<B;++e){var n=(e+this.current_idx)%B,i=e/B;t[e]||(t[e]={}),t[e].position=this.position_history[n];var r=255*i;t[e].color=new w(0,r,0)}return t}},{key:"draw",value:function(t,e){v.drawTraces&&this.drawTrace(e),t.fillStyle=this.color.toRGB(),t.beginPath(),t.arc(this.position.x,this.position.y,this.r,0,2*Math.PI),v.strokeBalls&&this.drawStroke(t),t.fill(),t.closePath(),this.drawStableScore(t)}},{key:"drawStroke",value:function(t){t.lineWidth=Math.min(3/T,10),t.strokeStyle=y.invert(this.color).toRGBA(.67),t.stroke()}},{key:"drawTrace",value:function(t){var e=this.getVA(),n=e[0].position;t.beginPath(),e.forEach((function(e){t.lineTo(e.position.x,e.position.y)})),t.lineTo(this.position.x,this.position.y),t.moveTo(n.x,n.y),t.closePath(),this.applyTraceColor(t,n)}},{key:"applyTraceColor",value:function(t,e){var n=t.createLinearGradient(e.x,e.y,this.position.x,this.position.y);n.addColorStop(0,"transparent"),n.addColorStop(1,_),t.strokeStyle=n,t.stroke()}},{key:"drawStableScore",value:function(t){M(t,this)}}]),t}();var H,q=.01,F=.5;function z(t,e){if(v.dragWithMouseOver){var n=t(e);return function(t){var e=n.sub(t.position),i=b.length(e),r=t.r;i<r&&(t.position=t.position.add(e.mul(q*(r-i))),t.velocity=t.velocity.add(e.mul(F*(r-i))))}}}function U(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];window.addEventListener(n?"keydown":"keyup",(function(n){n.code!==t&&n.key!==t||e()}))}function G(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=function(n){var i=function(){t(n),o()};function r(){window.removeEventListener("touchend",i)}function o(){window.removeEventListener("touchmove",r)}window.addEventListener("touchend",i,{once:!0}),window.addEventListener("touchmove",r,{once:!0}),setTimeout((function(){r(),o()}),e)};return window.addEventListener("touchstart",n),n}function K(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Y=function(){"use strict";function t(e){s(this,t),this.keysList=e,this.callbacks={},this.keys=Object.fromEntries(this.keysList.map((function(t){return[t,!1]}))),window.addEventListener("keydown",this.changeState.bind(this)),window.addEventListener("keyup",this.changeState.bind(this))}return f(t,[{key:"changeState",value:function(e){if(this.isKeyCodeInKeysList(e.code)&&(this.keys[e.code]="keydown"===e.type,!e.repeat&&this.keys[e.code])){var n,i,r=this;null===(i=(n=this.callbacks)[e.code])||void 0===i||i.call(n),setTimeout((function(){r.repeat(e)}),t.keyRepeatDelay)}}},{key:"isKeyCodeInKeysList",value:function(t){return this.keysList.includes(t)}},{key:"repeat",value:function(e){var n=this;if(this.keys[e.code])var i=setInterval((function(){var t,r;n.keys[e.code]?null===(r=(t=n.callbacks)[e.code])||void 0===r||r.call(t):clearInterval(i)}),t.keyRepeatInterval)}}]),t}();K(Y,"keyRepeatInterval",60),K(Y,"keyRepeatDelay",Y.keyRepeatInterval);var W={radius:{increment:"BracketRight",decrement:"BracketLeft",incrementFast:"}",decrementFast:"{"},velocity:{increment:"ArrowUp",decrement:"ArrowDown",rotateLeft:"ArrowLeft",rotateRight:"ArrowRight"}},X={default:.1,fast:.3},V={default:.2};function J(t,e){var n=t.r+t.r*e;t.r=Math.max(n,5)}function Z(t,e){var n=!0,i=!1,r=void 0;if(H)e(H);else try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){e(o.value)}}catch(t){i=!0,r=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}function $(t){t.velocity=t.velocity.mul(1+V.default)}function N(t){t.velocity=t.velocity.mul(1-V.default)}function Q(t){t.velocity=b.rotate(t.velocity,V.default,b.RotationDirection.Left)}function tt(t){t.velocity=b.rotate(t.velocity,V.default,b.RotationDirection.Right)}function et(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nt(t){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function it(t){return nt(t)}function rt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=it(t)););return t}function ot(t,e,n){return(ot="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=rt(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n||t):r.value}})(t,e,n)}function at(t,e){return(at=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ut(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}function ct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function st(t,e){return!e||"object"!=((n=e)&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof e?et(t):e;var n}function lt(t){var e=ct();return function(){var n,i=it(t);if(e){var r=it(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return st(this,n)}}var ft=function(t){"use strict";ut(n,t);var e=lt(n);function n(){var t;return s(this,n),K(et(t=e.apply(this,arguments)),"renderHistory",[]),K(et(t),"maximumSpeedHistory",[]),t}return f(n,[{key:"getFPS",value:function(){return this.renderHistory=this.renderHistory.filter((function(t){return t>Date.now()-1e3})),this.renderHistory.length}},{key:"getUPS",value:function(){return Math.round(1e3/this.time_step)}},{key:"cycle",value:function(t){var e,i,r,o=performance.now(),a=(e=it(n.prototype),i="cycle",r=this,ot(e,i,r)).call(this,t),u=performance.now()-o;return this.handleMaximumUPSCalculation(u),a&&this.renderHistory.push(Date.now()),a}},{key:"handleMaximumUPSCalculation",value:function(t){var e=Math.max(30,this.getFPS())/(1e3/t),n=1/e,i=this.getUPS()*n;if(i!==1/0)if(e>1){this.maximumSpeedHistory.push(i/(.9*e))}else this.maximumSpeedHistory.push(i);this.maximumSpeedHistory.length>=50&&this.maximumSpeedHistory.shift()}},{key:"getRecommendedMaximumUPS",value:function(){return Math.round(this.maximumSpeedHistory.reduce((function(t,e){return t+e}),0)/this.maximumSpeedHistory.length)}}]),n}(function(){"use strict";function t(e,n,i){var r=this;s(this,t),this.update=e,this.render=n,this.time_step=i,this.animation_frame_request=void 0,this.accumulated_time=i,this.time=0,this.startCycle=function(t){r.cycle(t)}}return f(t,[{key:"cycle",value:function(t){this.animation_frame_request=window.requestAnimationFrame(this.startCycle),this.accumulated_time+=t-this.time,this.time=t;var e=!1;for(this.accumulated_time>1e3&&(this.accumulated_time=this.time_step);this.accumulated_time>this.time_step;)this.accumulated_time-=this.time_step,this.update(t),e=!0;return e&&this.render(),e}},{key:"start",value:function(){this.animation_frame_request=window.requestAnimationFrame(this.startCycle)}},{key:"stop",value:function(){window.cancelAnimationFrame(this.animation_frame_request)}}]),t}());function dt(t,e,n,i){var r=100*v.bounciness,o=t.mul(e*r*-1);n.velocity=n.velocity.sub(o.div(n.r)),i.velocity=i.velocity.add(o.div(i.r))}var ht,vt=document.querySelector("#stats");function yt(t,e,n,i){if("0"!==window.getComputedStyle(vt).opacity){var r,o,a,u,c,s=["FPS: ".concat(t.getFPS()),"Speed: ".concat(t.getUPS()).concat(1===e?"":" / ".concat(e)),"Zoom: ".concat((a=n,u=2,c=Math.pow(10,u),Math.round(a*c)/c)),"Balls: ".concat(i.length),"Approximate Stability: ".concat((r=i,o=function(t){return t.stableCount>255},"".concat(Math.round(r.filter(o).length/r.length*100),"%"))),"Recommended Maximum Speed: ".concat(t.getRecommendedMaximumUPS())];vt.innerText=s.join("; ")}}function mt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;clearTimeout(ht),vt.style.opacity="1",ht=setTimeout((function(){vt.style.opacity=""}),t)}var pt=!1,wt=null;function bt(t){pt&&wt&&!H&&(wt={x:wt.x-t.movementX/T,y:wt.y-t.movementY/T})}var gt,kt,St=document.querySelector("#balls"),xt=St.getContext("2d"),Lt=document.querySelector("#traces"),_t=Lt.getContext("2d");function Et(){Pt(St),Pt(Lt)}function Pt(t){t.width=window.innerWidth,t.height=window.innerHeight}Et(),window.addEventListener("resize",Et),gt=function(t){(kt+=t)<0&&(kt=0),kt>1&&(kt=1),T=2.9*kt+.1},kt=.1,function(){var t=!1;window.addEventListener("wheel",(function(e){var n=e.deltaY;t||gt(-n/C.desktopInverted*j())}));var e=0;window.addEventListener("gesturestart",(function(e){A(e)&&(e.preventDefault(),t=!0)})),document.addEventListener("gesturechange",(function(t){if(A(t)){var n=t.scale-1;gt((n-e)*C.desktopPinch*j()),e=n}})),window.addEventListener("gestureend",(function(n){A(n)&&(e=0,t=!1)}))}(),function(){var t=null;window.addEventListener("touchstart",(function(e){var n=e.touches;n.length>1&&(t=I(n[0],n[1]))})),window.addEventListener("touchend",(function(){t=null}));var e=null!==navigator.userAgent.match(/iPhone|iPad|iPod/i);window.addEventListener("touchmove",(function(n){if(e){if(!A(n))return;!function(t){t.scale!==R&&t.preventDefault()}(n)}var i=n.touches;if(null!==t){var r=I(i[0],i[1]);gt((r-t)/C.mobileInverted*j()),t=r}}),e?{passive:!1}:void 0)}();var Mt,Rt,At,Ct,Ot=1,Tt=1,It=1,jt=1,Bt=[];function Dt(){jt=1===Ot?10:1}!function(){for(var t=0;t<20;t++){var e=d(2*Math.PI),n=350*Math.cos(e),i=350*Math.sin(e);Bt.push(new D(n+.5*St.width,i+.5*St.height,h(70,5)))}}(),Mt=Bt,Rt=Yt,At=70,Ct=5,window.addEventListener("contextmenu",(function(t){t.preventDefault();var e=Rt(t),n=new D(e.x,e.y,h(At,Ct));(function(t,e){var n=t.find((function(t){return t.hasLeastStableScore}));n&&(e.stableScore=n.stableScore)})(Mt,n),Mt.push(n)})),function(t,e,n){var i=function(i){var r=e(i);!function(t){if(!t)return;H=H===t?null:t}(n(r,t))};window.addEventListener("click",i),G((function(t){if(1===t.touches.length){var e=t.touches[0];i({x:e.clientX,y:e.clientY})}})),U("Escape",(function(){H=null}))}(Bt,Yt,(function(t,e){var n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value,c=t.sub(u.position);if(b.length(c)<u.r)return u}}catch(t){i=!0,r=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return null})),function(t){var e=new Y(Object.values(W).flatMap(Object.values));!function(t,e){e.callbacks[W.radius.increment]=function(){Z(t,(function(t){J(t,X.default)}))},e.callbacks[W.radius.decrement]=function(){Z(t,(function(t){J(t,-X.default)}))},U(W.radius.incrementFast,(function(){Z(t,(function(t){J(t,X.fast)}))}),!0),U(W.radius.decrementFast,(function(){Z(t,(function(t){J(t,-X.fast)}))}),!0)}(t,e),function(t,e){e.callbacks[W.velocity.increment]=function(){Z(t,$)},e.callbacks[W.velocity.decrement]=function(){Z(t,N)},e.callbacks[W.velocity.rotateLeft]=function(){Z(t,Q)},e.callbacks[W.velocity.rotateRight]=function(){Z(t,tt)}}(t,e)}(Bt),U("Space",Dt),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,i=function(i){var r=setTimeout((function(){setTimeout((function(){t(i)}),n),window.removeEventListener("touchend",o),window.removeEventListener("touchmove",a)}),e);function o(){u(),window.removeEventListener("touchmove",a)}function a(){u(),window.removeEventListener("touchend",o)}function u(){clearTimeout(r)}window.addEventListener("touchend",o,{once:!0}),window.addEventListener("touchmove",a,{once:!0})};window.addEventListener("touchstart",i)}(Dt),U("a",(function(){v.drawTraces=!v.drawTraces}));var Ht=0,qt={x:0,y:0};window.addEventListener("mousemove",(function(t){qt.x=t.x,qt.y=t.y,bt(t)}));var Ft,zt,Ut=new ft((function(t){It!==jt&&(It+=jt-It);var e=!0;if(!Tt){var n=!0,i=!1,r=void 0;try{for(var o,a=Bt[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;u.stable=!0,u.save()}}catch(t){i=!0,r=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}!(e=function(t,e){var n=function(e){var n=function(e){var n=t[e],r=function(){i=!1,c.stable=!1,n.stable=!1};!function(t,e,n){var i=t.position.sub(e.position),r=b.length(i),o=t.r+e.r;r<o&&(null==n||n(),function(t,e,n,i,r){var o=t.div(e);v.bounciness>0&&dt(o,n,i,r);var a=o.mul(.5*(n-e));i.position=i.position.add(a),r.position=r.position.sub(a),v.useAntiCollisionBug||(i.velocity=i.velocity.add(a),r.velocity=r.velocity.sub(a))}(i,r,o,t,e))}(c,n,r)},c=t[e],s=a.sub(c.position);c.velocity=c.velocity.add(s.mul(o)),null==u||u(c);for(var l=e+1;l<r;l++)n(l)},i=!0;E(t);for(var r=t.length,o=.01,a=new S(.5*St.width,.5*St.width),u=z(Yt,qt),c=0;c<r;c++)n(c);for(var s=0;s<r;s++)t[s].stable?t[s].stableCount++:t[s].stableCount=0,P(t[s]);return i}(Bt))&&Ht<200&&(Ht=0),e&&++Ht,It&&(Ot=It),Tt=Ot}(function(t,e){var n=.016,i=!0,r=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=a.value;c.position=c.position.add(c.velocity.mul(n/e))}}catch(t){r=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}Tt--})(Bt,Ot),zt=new S(0,0);var c=!0,s=!1,l=void 0;try{for(var f,d=Bt[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var h=f.value,y=Ht>199?1:Math.min(1,h.stableCount/255),m=x.mul(y).add(L.mul(1-y));zt=zt.add(h.position),h.color=m}}catch(t){s=!0,l=t}finally{try{c||null==d.return||d.return()}finally{if(s)throw l}}zt=zt.div(Bt.length)}),(function(){yt(Ut,Ot,T,Bt),Gt(xt),Gt(_t),Bt.forEach((function(t){return t.draw(xt,_t)})),t=xt,t.fillStyle="#ff0066",t.beginPath(),t.arc(zt.x,zt.y,10,0,2*Math.PI),t.fill(),t.closePath(),xt.restore(),_t.restore();var t}),1e3/60);function Gt(t){var e;t.clearRect(0,0,t.canvas.width,t.canvas.height),t.save(),t.scale(T,T),(e=t).translate.apply(e,c(Kt()))}function Kt(){var t,e,n;return[-(n=null!==(e=null!==(t=null==H?void 0:H.position)&&void 0!==t?t:wt)&&void 0!==e?e:zt).x+.5*St.width/T,-n.y+.5*St.height/T]}function Yt(t){var e=new S(t.x,t.y),n=o(Kt(),2),i=n[0],r=n[1],a=new S(i,r);return e.div(T).sub(a)}Ut.start(),U("KeyJ",function(t){return function(){mt(),t.time_step=Math.min(600,1.1*t.time_step)}}(Ft=Ut),!0),U("KeyL",function(t){var e=.9,n=t instanceof ft;return function(){mt();var i=t.time_step*e;if(n){var r=Math.round(1e3/i),o=.9,a=t.getRecommendedMaximumUPS()*o;if(r<=a)t.time_step=i;else{var u=1e3/a;u<t.time_step&&(t.time_step=u)}}else t.time_step=i}}(Ft),!0),window.addEventListener("mouseup",(function(){pt=!1})),U("Escape",(function(){wt=null})),window.addEventListener("mousedown",(function(){var t;t=zt,H||(pt=!0,wt||(wt={x:t.x,y:t.y}))}))}();